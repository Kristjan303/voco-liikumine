<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Registreeri</title>
</head>
<body>
<form action="/signup" method="post" class="signup" enctype="application/x-www-form-urlencoded" onsubmit="return validateForm()">
  <label for="username">Kasutajanimi</label>
  <input type="text" id="username" name="username" placeholder="Sisesta Kasutajaniimi">
  <label for="phonenumber">Telefon</label>
  <input type="text" id="phonenumber" name="phonenumber" placeholder="Sisesta telefon">
  <label for="email">Email</label>
  <input type="email" id="email" name="email" placeholder="Sisesta email">
  <label for="password">Parool</label>
  <input type="password" id="password" name="password" placeholder="Sisesta parool">
  <input type="submit" value="Sisene">
</form>

<div class="error" id="error-message-container">
  <!-- Error message will be dynamically inserted here -->
</div>

<!-- JavaScript to display error message -->



</body>
<script>
  function validateForm() {
    // Clear previous error message
    document.getElementById('error-message-container').innerHTML = '';

    // Perform form validation if needed

    // Use fetch to submit the form data
    fetch('/signup', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        username: document.getElementById('username').value,
        phonenumber: document.getElementById('phonenumber').value,
        email: document.getElementById('email').value,
        password: document.getElementById('password').value
      })
    })
            .then(response => response.json())
            .then(result => {
              if (!result.success) {
                // Display the error message
                const errorMessageContainer = document.getElementById('error-message-container');
                const errorMessageElement = document.createElement('div');
                errorMessageElement.className = 'error-message';
                errorMessageElement.innerText = result.message;
                errorMessageContainer.appendChild(errorMessageElement);
              } else {
                // Redirect to the login page or perform any other action on successful signup
                window.location.href = '/sisene';
              }
            })
            .catch(error => {
              console.error('Error submitting form:', error);
              // Handle error if needed
            });

    // Return false to prevent the default form submission
    return false;
  }
</script>

</html>
